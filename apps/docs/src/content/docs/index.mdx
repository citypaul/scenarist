---
title: Scenarist
description: Browser-based testing where your backend actually runs. Test API routes, validation logic, SSR, and Server Components with real execution across any Node.js framework.
template: splash
hero:
  title: Browser Testing That Actually Runs Your Backend
  tagline: Test your backend logic in the browser without compromises. Traditional approaches either mock everything (your code never runs) or require slow app restarts per scenario. Scenarist mocks only external APIs while your API routes, validation logic, middleware, SSR, and Server Components execute normally. Works with Express, Next.js, Hono, Fastify, and any Node.js framework. Instant scenario switching in Playwright with type-safe helpers.
  image:
    file: ../../assets/hero-illustration.svg
    alt: Illustration showing backend server with API routes, Server Components, and validation connected to a browser running tests
  actions:
    - text: Get Started
      link: /introduction/quick-start
      icon: right-arrow
      variant: primary
    - text: View on GitHub
      link: https://github.com/citypaul/scenarist
      icon: external
      variant: secondary
---

import { Card, CardGrid, Tabs, TabItem } from '@astrojs/starlight/components';

---

## Your Backend Code Actually Runs

**Unlike pure mocking solutions, Scenarist tests your real application logic.** Your API routes process requests. Your validation logic checks business rules. Your middleware chains execute. Your SSR fetches and transforms data. Your Server Components render (Next.js). Only external API calls (Stripe, SendGrid, Auth0, etc.) are mocked. This means you're testing the actual code that runs in production, not just mock responses.

:::tip[The Critical Difference]
**Traditional browser tests:** Mock everything → Backend never runs → Testing mock responses

**Scenarist approach:** Mock only external APIs → Backend runs normally → Testing real application behavior

**Works across all Node.js frameworks:** Express REST APIs, Hono edge functions, Fastify microservices, Next.js Server Components, Remix loaders—any backend logic that needs browser-based testing.
:::

**Framework-agnostic with thin adapters:** Express, Next.js (Pages + App Router), Fastify, Hono, Remix, and SvelteKit.

---

## Playwright Integration with Type Safety

Scenarist includes **first-class Playwright support** with helpers that eliminate boilerplate and guarantee test isolation:

**Code Reduction: 77%** - From 9 lines of boilerplate to 2 lines:

```typescript
// ❌ Without helpers (9 lines per test)
const testId = `test-premium-${Date.now()}`;
const response = await page.request.post('http://localhost:3000/api/__scenario__', {
  headers: { 'x-test-id': testId },
  data: { scenario: 'premiumUser' },
});
expect(response.status()).toBe(200);
await page.setExtraHTTPHeaders({ 'x-test-id': testId });

// ✅ With helpers (2 lines - configured once)
import { test, expect } from '@scenarist/playwright-helpers';
await switchScenario(page, 'premiumUser');
```

**Type-Safe Scenario IDs** - Get autocomplete and compile-time validation:

```typescript
// Define scenarios once
const scenarios = {
  cartWithState: { id: 'cartWithState', name: 'Cart with State', ... },
  premiumUser: { id: 'premiumUser', name: 'Premium User', ... },
} as const satisfies ScenaristScenarios;

// Create typed test object
export const test = withScenarios(scenarios);

// TypeScript autocomplete in tests
test('my test', async ({ page, switchScenario }) => {
  await switchScenario(page, 'cartWithState'); // ✅ Autocomplete works!
  await switchScenario(page, 'typo');          // ❌ TypeScript error
});
```

**Guaranteed Test Isolation** - Unique test IDs prevent collisions in parallel execution (uses `crypto.randomUUID()` per test).

**Easy Composition** - Extend with your existing Playwright fixtures:

```typescript
export const test = withScenarios(scenarios).extend<MyFixtures>({
  authenticatedPage: async ({ page }, use) => { /* your fixture */ },
  database: async ({}, use) => { /* your fixture */ },
});
```

[Learn more about Playwright helpers →](https://github.com/citypaul/scenarist/tree/main/packages/playwright-helpers)

---

## Why Scenarist?

| Feature | Jest/Vitest | Playwright (Mocked) | Playwright (True E2E) | Cypress | **Scenarist + Playwright** |
|---------|-------------|---------------------|----------------------|---------|----------------------------|
| **Test Type** | Unit tests | Browser (mocked) | Browser (real backend) | Browser (mocked) | **Browser (real backend)** |
| **Your Backend Runs** | N/A (no server) | ❌ Never runs | ✅ Yes | ❌ Stubs only | ✅ **Always executes** |
| **Server Components** | ❌ Can't test | ❌ Never execute | ✅ Yes | ❌ Not supported | ✅ **Real execution** |
| **External API Handling** | N/A | Manual mocks | ⚠️ Real calls (flaky) | Manual mocks | ✅ **MSW integration** |
| **Change Scenarios** | N/A | Restart app | Restart app¹ | Restart tests | ✅ **Instant switching** |
| **Parallel Tests** | ✅ Fast | ❌ Shared state² | ⚠️ Limited³ | ⚠️ Limited | ✅ **Perfect isolation** |
| **Test Speed** | ✅ Instant | ⚠️ Slow (restarts) | ⚠️ Very slow (restarts + real APIs) | ⚠️ Slow | ✅ **Fast** |
| **State Management** | N/A | Manual setup | Manual setup | Manual setup | ✅ **Built-in capture** |

:::tip[Why This Matters]
**Jest/Vitest**: Can't test full-stack flows or browser interactions

**Playwright (Mocked)**: Backend never runs—you're testing mock responses, not your actual API routes, validation, or business logic

**Playwright (True E2E)**: Backend runs but requires app restarts per scenario + real external API calls (slow and flaky)

**Cypress**: Stubs everything—API routes never execute, validation never runs, middleware never processes

**Scenarist + Playwright**: Real backend execution (API routes, validation, middleware, SSR) + mocked external APIs + instant scenario switching + built-in state = fast full-stack tests
:::

<small>¹True E2E requires restarting app to change backend state/config per scenario
²Shared MSW handlers cause test pollution and flaky tests in parallel execution
³Port conflicts and shared state make parallel execution difficult</small>

---

## Quick Example

<Tabs>
<TabItem label="Express" icon="seti:nodejs">

```typescript
// src/scenarios.ts
import type { ScenaristScenario, ScenaristScenarios } from '@scenarist/express-adapter';

const successScenario: ScenaristScenario = {
  id: 'success',
  name: 'Payment Success',
  mocks: [{
    method: 'POST',
    url: 'https://api.stripe.com/v1/charges',
    response: { status: 200, body: { id: 'ch_123', status: 'succeeded' } },
  }],
};

export const scenarios = {
  default: successScenario,
  success: successScenario,
} as const satisfies ScenaristScenarios;

// src/setup.ts
import { createScenarist } from '@scenarist/express-adapter';
import { scenarios } from './scenarios';

export const scenarist = createScenarist({
  enabled: process.env.NODE_ENV === 'test',
  scenarios,
});

// src/app.ts
import { scenarist } from './setup';
const app = express();
app.use(scenarist.middleware);  // Everything wired automatically

// tests/checkout.spec.ts
import { test, expect } from '@scenarist/playwright-helpers';

test('successful checkout', async ({ page, switchScenario }) => {
  await switchScenario(page, 'success');
  await page.goto('/checkout');
  await page.fill('[name="amount"]', '100');
  await page.click('button[type="submit"]');

  await expect(page.locator('.success')).toBeVisible();
});
```

</TabItem>

<TabItem label="Next.js (Pages)" icon="seti:next">

```typescript
// lib/scenarios.ts
import type { ScenaristScenario, ScenaristScenarios } from '@scenarist/nextjs-adapter/pages';

const successScenario: ScenaristScenario = {
  id: 'success',
  name: 'Payment Success',
  mocks: [{
    method: 'POST',
    url: 'https://api.stripe.com/v1/charges',
    response: { status: 200, body: { id: 'ch_123', status: 'succeeded' } },
  }],
};

export const scenarios = {
  default: successScenario,
  success: successScenario,
} as const satisfies ScenaristScenarios;

// lib/scenarist.ts
import { createScenarist } from '@scenarist/nextjs-adapter/pages';
import { scenarios } from './scenarios';

export const scenarist = createScenarist({
  enabled: process.env.NODE_ENV === 'test',
  scenarios,
});

// pages/api/__scenario__.ts
import { scenarist } from '@/lib/scenarist';
export default scenarist.createScenarioEndpoint();

// tests/checkout.spec.ts
import { test, expect } from '@scenarist/playwright-helpers';

test('successful checkout', async ({ page, switchScenario }) => {
  await switchScenario(page, 'success');
  await page.goto('/checkout');
  await page.fill('[name="amount"]', '100');
  await page.click('button[type="submit"]');

  await expect(page.locator('.success')).toBeVisible();
});
```

</TabItem>

<TabItem label="Next.js (App Router)" icon="seti:next">

```typescript
// lib/scenarios.ts
import type { ScenaristScenario, ScenaristScenarios } from '@scenarist/nextjs-adapter/app';

const successScenario: ScenaristScenario = {
  id: 'success',
  name: 'Payment Success',
  mocks: [{
    method: 'POST',
    url: 'https://api.stripe.com/v1/charges',
    response: { status: 200, body: { id: 'ch_123', status: 'succeeded' } },
  }],
};

export const scenarios = {
  default: successScenario,
  success: successScenario,
} as const satisfies ScenaristScenarios;

// lib/scenarist.ts
import { createScenarist } from '@scenarist/nextjs-adapter/app';
import { scenarios } from './scenarios';

export const scenarist = createScenarist({
  enabled: process.env.NODE_ENV === 'test',
  scenarios,
});

// app/api/__scenario__/route.ts
import { scenarist } from '@/lib/scenarist';

const handler = scenarist.createScenarioEndpoint();
export const POST = handler;
export const GET = handler;

// tests/checkout.spec.ts
import { test, expect } from '@scenarist/playwright-helpers';

test('successful checkout', async ({ page, switchScenario }) => {
  await switchScenario(page, 'success');
  await page.goto('/checkout');
  await page.fill('[name="amount"]', '100');
  await page.click('button[type="submit"]');

  await expect(page.locator('.success')).toBeVisible();
});
```

</TabItem>
</Tabs>

---

## Get Started

<CardGrid>
  <Card title="Quick Start" icon="rocket">
    Framework-agnostic 5-minute guide. Works with Express, Next.js, Fastify, Hono, Remix, and any Node.js framework.

    [Get Started →](/introduction/quick-start)
  </Card>
  <Card title="Playwright Helpers" icon="approve-check">
    Type-safe scenario switching with 77% less boilerplate. Guaranteed test isolation for parallel execution.

    [Playwright Guide →](https://github.com/citypaul/scenarist/tree/main/packages/playwright-helpers)
  </Card>
  <Card title="Express Setup" icon="seti:nodejs">
    REST APIs, GraphQL servers, microservices. Zero boilerplate with AsyncLocalStorage.

    [Express Guide →](/frameworks/express/getting-started)
  </Card>
  <Card title="Next.js Setup" icon="seti:next">
    Test Server Components, Server Actions, and API routes. Supports Pages and App Router.

    [Next.js Guide →](/frameworks/nextjs/getting-started)
  </Card>
  <Card title="Example Apps" icon="open-book">
    Explore complete working examples with comprehensive test suites.

    [View Examples →](https://github.com/citypaul/scenarist/tree/main/apps)
  </Card>
</CardGrid>
