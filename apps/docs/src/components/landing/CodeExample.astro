---
// Split-view code example showing scenario definition and test
import { Code } from 'astro:components';

const scenarioCode = `const successScenario = {
  id: 'payment_success',
  mocks: [{
    url: 'https://api.stripe.com/*',
    method: 'POST',
    response: {
      status: 200,
      body: { paid: true }
    }
  }]
};`;

const testCode = `test('checkout flow', async ({ page }) => {
  await switchScenario(page, 'payment_success');

  // Hits real Next.js backend
  await page.goto('/checkout');
  await page.click('#pay-button');

  // Real DB, Real Middleware, Mocked Stripe
  await expect(page).toHaveURL('/success');
});`;
---

<section class="relative z-10 px-6 pb-20">
  <div class="max-w-5xl mx-auto relative">
    <!-- Glow effect behind the code block -->
    <div class="absolute -inset-1 bg-gradient-to-r from-primary to-secondary opacity-10 dark:opacity-20 blur-2xl rounded-xl"></div>

    <!-- Code block container -->
    <div class="relative bg-white dark:bg-[#0A0A0C] border border-gray-200 dark:border-white/10 rounded-xl overflow-hidden shadow-2xl">
      <!-- Window header -->
      <div class="flex items-center justify-between px-4 py-3 border-b border-gray-100 dark:border-white/5 bg-gray-50 dark:bg-white/[0.02]">
        <div class="flex gap-2">
          <div class="w-3 h-3 rounded-full bg-[#FF5F56]"></div>
          <div class="w-3 h-3 rounded-full bg-[#FFBD2E]"></div>
          <div class="w-3 h-3 rounded-full bg-[#27C93F]"></div>
        </div>
        <div class="text-xs font-mono text-gray-400 dark:text-gray-500">scenario.ts â€” checkout.spec.ts</div>
        <div class="w-10"></div>
      </div>

      <!-- Split code panels -->
      <div class="grid md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-gray-100 dark:divide-white/10">
        <!-- Left Panel - Define Scenario -->
        <div class="p-6">
          <div class="text-gray-400 dark:text-gray-500 mb-4 text-xs uppercase tracking-widest font-bold">1. Define Scenario</div>
          <div class="code-panel [&_pre]:!bg-transparent [&_pre]:!p-0 [&_pre]:!m-0 [&_code]:!text-sm [&_code]:!leading-relaxed">
            <Code code={scenarioCode} lang="typescript" theme="dracula" />
          </div>
        </div>

        <!-- Right Panel - Run Test -->
        <div class="p-6 bg-gray-50 dark:bg-[#161618]/30">
          <div class="text-gray-400 dark:text-gray-500 mb-4 text-xs uppercase tracking-widest font-bold">2. Run Test</div>
          <div class="code-panel [&_pre]:!bg-transparent [&_pre]:!p-0 [&_pre]:!m-0 [&_code]:!text-sm [&_code]:!leading-relaxed">
            <Code code={testCode} lang="typescript" theme="dracula" />
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
